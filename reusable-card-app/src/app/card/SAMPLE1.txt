    @Test
    void testInsertPaymentLines_UserException() {
        // Create a list of PaymentLinesFeoModel objects
        List<PaymentLinesFeoModel> paymentLines = new ArrayList<>();
        PaymentLinesFeoModel paymentLine1 = new PaymentLinesFeoModel();
        paymentLine1.setInvoiceReference("INV123");
        paymentLines.add(paymentLine1);

        // Mock InvoiceServiceApi.getListOfInvoices()
        List<InvoicePayableModel> invoices = new ArrayList<>();
        InvoicePayableModel invoice1 = new InvoicePayableModel();
        invoice1.setInvoiceReference("INV123");
        invoice1.setAmount(BigDecimal.TEN);
        invoice1.setInvoiceType("CREDIT");
        invoices.add(invoice1);

        when(invoiceServiceApi.getListOfInvoices(List.of("INV123"))).thenReturn(invoices);

        // Mock ReferentialServiceApi.getUserInitials() to throw an exception
        when(referentialServiceApi.getUserInitials("testUser")).thenThrow(new RuntimeException("User exception"));

        // Call the method and verify the error
        InsertPaymentResponse response = cashAllocationDomain.insertPaymentLines(paymentLines, "testUser");
        assertNotNull(response.getErrorMessage());
    }